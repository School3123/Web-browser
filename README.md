# 🐍 Python 高速リモートブラウザ（音声なし・最適化版）説明書

このプログラムは、GitHub Codespaces（サーバー側）で本物の Firefox ブラウザを動作させ、その画面を**高品質な連続写真（MJPEG形式）**として手元のブラウザに転送する仕組みのリモートブラウザです。

音声処理や複雑な動画エンコードを省くことで、**操作レスポンスの速さ**と**画質の鮮明さ**を両立させています。

---

## 1. 動作環境の準備
GitHub Codespaces のターミナルで、以下のコマンドを順番に実行してください。

```bash
# 1. 必要なライブラリのインストール
pip install flask playwright cryptography

# 2. ブラウザエンジン（Firefox）の個別インストール
playwright install firefox

# 3. Linuxシステム用の依存ファイルを一括インストール（重要）
sudo playwright install-deps firefox
```

---

## 2. 起動方法
1.  ファイルエクスプローラーで `app.py` を開き、最新のコードを貼り付けて保存します。
2.  ターミナルでプログラムを実行します。
    ```bash
    python app.py
    ```
3.  画面右下に表示される **「Open in Browser」** ボタンをクリックします。

### ⚠️ セキュリティ警告の突破
本システムは通信保護のため自己署名証明書（HTTPS）を使用しています。そのため、初回アクセス時にブラウザで警告が表示されます。
*   **「詳細設定」** をクリック。
*   **「～に移動する（安全ではありません）」** をクリックしてページを開いてください。

---

## 3. 基本操作ガイド

| 操作 | 内容 |
| :--- | :--- |
| **サイト移動** | 上部の入力窓にURLを入力し、Enterキーまたは「移動」ボタンを押す。 |
| **クリック** | 画面内のリンクやボタンを直接クリック。サーバー側のFirefoxが反応します。 |
| **文字入力** | 入力欄（検索窓など）をクリックした後、そのままキーボードでタイピング。 |
| **スクロール** | マウスホイール、またはタッチパネルでのスクロール操作に対応。 |
| **特殊キー** | Enter、Backspace、矢印キー等の主要なキーボード操作が同期されます。 |

---

## 4. このシステムの特徴
*   **フルHD対応:** 1920x1080 の解像度でブラウジングが可能です。
*   **レスポンシブ設計:** お使いのブラウザ画面のサイズに合わせて、画像が自動的に拡大・縮小されます。比率が変わってもクリック位置は自動補正されます。
*   **低遅延・高画質:** 動画（Video）に変換せず、JPEGを高速に連射して送る「MJPEG」方式を採用。文字の輪郭がくっきり表示され、操作のラグも最小限です。
*   **非同期処理:** Flask（通信）とPlaywright（ブラウザ操作）を別スレッドで処理しているため、複数のリクエストが重なってもフリーズしにくい設計です。

---

## 5. トラブルシューティング

#### 画面が真っ暗、または「？」が出る
*   **原因:** サーバー側でのFirefoxの起動（約5〜10秒）が完了していない可能性があります。
*   **対策:** ターミナルに `=== Firefox Engine Started ===` と出るまで待ち、ページを更新（F5）してください。

#### 動作が重い（カクつく）
*   **原因:** 回線速度不足、またはCodespacesのCPU負荷が高い。
*   **対策:** `app.py` 冒頭の `CONFIG` 内にある `"quality": 85` を `60` や `50` に下げると、データ量が減りスムーズになります。

#### ポート設定
*   まれに画像がブロックされる場合、Codespacesの「Ports」タブから Port 5000 の **Visibility** を **「Public」** に変更してください。

---

## 6. 技術仕様
*   **Backend:** Python 3.x, Flask
*   **Browser Engine:** Playwright (Firefox)
*   **Streaming Content-Type:** `multipart/x-mixed-replace` (MJPEG)
*   **Resolution:** 1920 x 1080 (Scaling enabled)
